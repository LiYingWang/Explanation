---
title:
  # Title must be 150 characters or less
  "A Capitalized Title: Something about a great Discovery"
author:
  - name: Liying Wang
    affiliation: '1,2'
    # If corresponding author (only one corresponding author per manuscript)
    email: liying15@uw.edu
affiliation:
  - id: '1'
    department: Department/Anthropology/Center
    institution: Institution Name
    city: Seattle
    state: Washington
    country: USA
  - id: '2' 
    department: Dept/Program/Center
    institution: Institution Name
    city: City
    state: State
    country: Country
output: rticles::plos_article
csl: plos.csl
# bibliography: library.bib
---
My potential questions for this quantitative research project as following:

1. What is the trend of research of social inequality in archaeology in the past decades? Is it popular in any particular time period?

2. How often social inequality relates to culture contact? Especially for European contact. Also, does any area show preference of such research, such as North America, Southeast Asia, Oceania, or Africa.    

3. For the method, what is the relationship between the term "inequality" and other archaeological evidence, including burials, ceramics, post holes, or glass beads.

In order to run the codes for my questions, I will use the following two libraries: 

```{r data_input}
library(JSTORr)
# multiple_archives <- JSTOR_unpack_multiple_archives(mydir = "data/one_gram")
# save(multiple_archives, file= "data/one_gram/multiple_archives.RData" 
load("data/one_gram/multiple_archives.RData")
# library(devtools)
# download and install the package (do this only once ever per computer)
install_github("benmarwick/JSTORr")
```

```{r load_data_bigram}
# setwd("data/two_gram")
# bigrams <- JSTOR_unpack2grams()
# save(bigrams, file = "bigrams.RData")
load("data/two_gram/bigrams.RData")
```

```{r subset_data}
nouns_Asia<- JSTOR_dtmofnouns(multiple_archives, word = "asia", sparse =1, POStag = TRUE)
nouns_Ame<- JSTOR_dtmofnouns(multiple_archives, word = "america", sparse =1, POStag = TRUE)
nouns_Oce<- JSTOR_dtmofnouns(multiple_archives, word = "oceania", sparse =1, POStag = TRUE)
nouns_Afr<- JSTOR_dtmofnouns(multiple_archives, word = "africa", sparse =1, POStag = TRUE)
```

For the first question of the trend of social inequality, the plots show that the topic of inequality becomes common after maybe 1992, and then has became popular around 2006. The term "social" is commoner than the term "inequality". I think the reason is that this term "social" is too general. The third graph shows that social and inequality were decussated together after 1978, but slightly goes down around 1986, and then popular again from 1994.

```{r onegram}
# one word over time
inequality <- JSTOR_1word(multiple_archives, "inequality")
inequality_tbl <- inequality$word_by_year
inequality_tbl[which.max(inequality_tbl$word_by_year), ]
# two words over time
two_soc_ine <- JSTOR_2words(multiple_archives, "social", "inequality")
two_soc_ine_tbl <- two_soc_ine$words_by_year
two_soc_ine_tbl[which.max(two_soc_ine_tbl$value), ]
# correlation of words over time
cor_soc_ine <- JSTOR_2wordcor(multiple_archives, "social", "inequality")
soc_ine_paper <- two_soc_ine_tbl[(two_soc_ine_tbl$year == 2007), ]
soc_ine_paper[which.max(soc_ine_paper$value), ]
```

If I use "social inequality" as a term, the plots shows that such discussion only exists after 1978, becomes popular around 2000, and slightly goes down at 2002. In archaeology, social inequality is one of the indexes for social complexity. Therefore, I will also examine the discussion of social complexity in order to have a general understanding of such topic. The discussion of "social complexity" begins from 1947, becomes popular at around 1978, slightly goes down at 1990 and 2006, and then popular again at 2010. It seems like there is not big change in the discussion of these two terms. If we examine these two terms over time, the plot shows that they have different pattern of frequency. When social inequality was frequently discusses, the frequency of social complexity becomes lower. This might indicates the terms of social inequality and social complexity might have some pattern of relationship, which is to some extent mutually exclusive. Social inequality could be viewed as more specific approach to social complexity. 

```{r bigrams}
# one word over time
social_inequality <- JSTOR_1bigram(bigrams, "social inequality")
social_inequality_tbl <- social_inequality$data
social_inequality_tbl[which.max(social_inequality_tbl$bigram_ratio), ]
JSTOR_1bigram(bigrams, "social complexity")
# correlation of words over time
JSTOR_2bigrams(bigrams, "social inequality", "social complexity")
```

For the second question about the correlation between social inequality and European contact, the plot of two terms shows that there is a similar trend before 1994, but after 1994 there is no clear pattern shows the relationship. When we further examine the correlation between these two terms, the plot indicates that there is only an article shows the relatively strong correlation at 1996. In addition to European contact, I also examine the correlation between social inequality and social complexity. The plot shows that they are strongly correlated at 1987, 1998, and 2007, which shows the periodic pattern of discussion. This plot also explains the pattern in the former plot of word frequency over time.

```{r bigrams}
# two words over timw
JSTOR_2bigrams(bigrams, "social inequality", "european contact")
# correlation of words over time
JSTOR_2bigramscor(bigrams, "social complexity", "european contact")
JSTOR_2bigramscor(bigrams, "social complexity", "social inequality")
```

These plots show the relationship between the term 'inequality' and other archaeological evidence, including beads, burials, and pottery.For the beads, it idicates that couple of articles have strong positive correlation around 1990. In addition, there is no much discussion until 1976. For the burials, I also shows that the dicussion of burial and inequality become common after the publication of the article in 1976. Besides, is seems there could be divided into two groups according to the extent of correlation. For the pottery, there is no clear correlation until 2006. After 2006, couple of articles shows the positive correlation. Based on this results, I can further explore these articles with positive correaltion.   

```{r onegram}
# subset the data to different area
Asi_data <- JSTOR_subset1grams(multiple_archives,"asia")
Oce_data <- JSTOR_subset1grams(multiple_archives,"oceania")
Ame_data <- JSTOR_subset1grams(multiple_archives,"america")
Afr_data <- JSTOR_subset1grams(multiple_archives,"africa")
# one word, inequality, in different area
JSTOR_1word(Asi_data, "inequality")
JSTOR_1word(Oce_data, "inequality")
JSTOR_1word(Ame_data, "inequality")
JSTOR_1word(Afr_data, "inequality")
# correlation of inequality and evidence over time
JSTOR_2wordcor(multiple_archives, "burials", "inequality")
JSTOR_2wordcor(multiple_archives, "pottery", "inequality")
JSTOR_2wordcor(multiple_archives, "bead", "inequality")
# correlation of contact and inequality in different area
JSTOR_2wordcor(nouns_Asia, "contact", "inequality")
JSTOR_2wordcor(nouns_Ame, "contact", "inequality")
JSTOR_2wordcor(nouns_Oce, "contact", "inequality")
```

TBA

```{r onegram}
# subset samples
nouns<- JSTOR_dtmofnouns(multiple_archives, word = NULL, sparse =1, POStag = TRUE)
# Principal component analysis for articles containing inequality
PCA_inequality <- JSTOR_clusterbywords(nouns, "inequality", f = 0.005)
PCA_inequality <- JSTOR_clusterbywords(nouns_Asia, "inequality", f = 0.005)
PCA_inequality <- JSTOR_clusterbywords(nouns_Ame, "inequality", f = 0.005)
PCA_inequality <- JSTOR_clusterbywords(nouns_Oce, "inequality", f = 0.005)
# Two words
PCA_social_ineq <- JSTOR_clusterbywords(nouns, c("inequality", "social"), f = 0.005)
```

The frequency of words containing “inequality” shows that the focus changes with time. The focus of paper shift from population, organization, and mound to ritual, power and pottery, which indicates there is a trend of anthropological thinking from 2006. Besdies, The term settlement could be observed in each period from 1996 until now, and it becomes more popular over time. 

```{r onegram}
# Top words containing 'inequality' over time
# exclude some irrelevant words
custom_stopwords <- c('archaeology', 'university', 'research', 'evidence', 'journal', 'world', 'site', 'cambridge', 'archaeol', 'area', 'region', 'period', 'analysis', 'anthropology', 'springer', 'production', 'figure', 'work', 'world', 'concept', 'human', 'middle', 'altamira', 'culture', 'record', 'citation', 'discipline', 'author', 'proportion', 'literature', 'report', 'approach', 'cambridge' )
ineq_nouns <- JSTOR_dtmofnouns(multiple_archives, word = 'inequality', sparse =1, POStag = TRUE)
ineq_freqwords <- JSTOR_freqwords(multiple_archives, ineq_nouns, custom_stopwords, n = 5)
con_nouns <- JSTOR_dtmofnouns(multiple_archives, word = 'contact', sparse =1, POStag = TRUE)
con_freqwords <- JSTOR_freqwords(multiple_archives, con_nouns, custom_stopwords, n = 10)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

################################################################
Qestion: 
1.If I use bigram code, the terms should be both 2gram? If one is 1gram, and another one is 2gram.
2.Data subset only works in PCA? How can I subset the data for 2 words correlation? 
3.Can I examine the top word for 2-gram?

